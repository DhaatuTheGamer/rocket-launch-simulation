<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Realistic Rocket Launch</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div id="vab-modal" style="display:none;">
        <div class="content">
            <h2>‚öôÔ∏è Vehicle Assembly Building</h2>
            <div class="control-group">
                <label>Fuel Mass (tons): <span id="val-fuel">30</span></label>
                <input type="range" id="rng-fuel" min="10" max="100" value="30">
            </div>
            <div class="control-group">
                <label>Max Thrust (MN): <span id="val-thrust">2.0</span></label>
                <input type="range" id="rng-thrust" min="1.0" max="5.0" step="0.1" value="2.0">
            </div>
            <div class="control-group">
                <label>Aerodynamics (Cd): <span id="val-drag">0.5</span></label>
                <input type="range" id="rng-drag" min="0.1" max="1.0" step="0.1" value="0.5">
            </div>
            <button id="vab-launch-btn" class="primary large">GO FOR LAUNCH</button>
        </div>
    </div>

    <div id="splash-screen">
        <div class="content">
            <h1>ORBITAL LAUNCH SIMULATOR</h1>
            <p class="subtitle">Multi-Stage Physics & Landing Simulation</p>

            <div class="mission-guide">
                <h2>üìã Full Mission Profile Guide</h2>
                <ol>
                    <li><strong>LIFTOFF:</strong> Press <span class="key">SPACE</span>. Engines ignite at T-0.</li>
                    <li><strong>GRAVITY TURN:</strong> At <strong>2.0 km</strong>, tap <span class="key">RIGHT
                            ARROW</span> to tilt slightly (~10¬∞).</li>
                    <li><strong>MAX Q:</strong> Watch for camera shake and vapor cones around 300 m/s.</li>
                    <li><strong>STAGING:</strong> When APOGEE > 100km (or fuel low), press <span class="key">S</span>.
                    </li>
                    <li><strong>LANDING (Optional):</strong> Press <span class="key">B</span> to track Booster. Use
                        <span class="key">ARROWS</span> to guide the <strong>Red Impact Marker</strong> to the pad.
                    </li>
                    <li><strong>ORBIT:</strong> Press <span class="key">1</span> for Upper Stage. Coast to space.</li>
                    <li><strong>PAYLOAD:</strong> In vacuum, press <span class="key">P</span> to deploy Satellite.</li>
                </ol>
            </div>

            <button id="open-vab-btn" class="large">‚öôÔ∏è CONFIGURE ROCKET</button>
            <button id="start-btn" class="primary large">üöÄ ENTER MISSION CONTROL</button>
        </div>
    </div>

    <div id="ui-layer">
        <!-- New HUD Header -->
        <div id="hud-top-bar">
            <div class="hud-module">
                <div class="hud-label">ALTITUDE</div>
                <div class="hud-value-large"><span id="hud-alt">0.0</span> <span class="unit">km</span></div>
            </div>
            <div class="hud-module">
                <div class="hud-label">APOGEE</div>
                <div class="hud-value-large"><span id="hud-apogee">0.0</span> <span class="unit">km</span></div>
            </div>
            <div class="hud-module">
                <div class="hud-label">VELOCITY</div>
                <div class="hud-value-large"><span id="hud-vel">0</span> <span class="unit">m/s</span></div>
            </div>
        </div>

        <div id="hud-gauges">
            <div class="gauge-container">
                <div class="gauge-bar-bg">
                    <div id="gauge-fuel" class="gauge-bar-fill" style="height: 100%; background-color: #f1c40f;"></div>
                </div>
                <div class="gauge-label">FUEL</div>
            </div>
            <div class="gauge-container">
                <div class="gauge-bar-bg">
                    <div id="gauge-thrust" class="gauge-bar-fill" style="height: 0%; background-color: #e74c3c;"></div>
                </div>
                <div class="gauge-label">THRUST</div>
            </div>
        </div>

        <div style="position: absolute; bottom: 160px; left: 20px; pointer-events: none;">
            <canvas id="navball" width="140" height="140" style="background:transparent;"></canvas>
        </div>
        <div style="display:none">
            <canvas id="graph-canvas"></canvas>
        </div>

        <!-- SAS Controls -->
        <div id="sas-controls">
            <div style="margin-bottom: 5px; font-weight: bold; color: #3498db; text-align:right;">SAS CONTROL</div>
            <div class="sas-group">
                <button id="sas-off" class="sas-btn active">OFF</button>
                <button id="sas-stability" class="sas-btn">STABILITY</button>
            </div>
            <div class="sas-group">
                <button id="sas-prograde" class="sas-btn">PROGRADE</button>
                <button id="sas-retrograde" class="sas-btn">RETROGRADE</button>
            </div>
        </div>

        <div id="mission-log">
            <h3>MISSION LOG</h3>
            <ul id="log-list">
            </ul>
        </div>
    </div>

    <div id="controls-help">
        [SPACE] Launch | [S] Stage | [P] Payload | [ARROWS] Control | [1-3] Cam | [ / ] Time | [M] Map | [A] Auto
    </div>

    <div id="status-msg">T-MINUS 3 SECONDS</div>

    <div id="controls">
        <button id="launch-btn" class="primary">Initiate Launch</button>
        <button id="autopilot-btn">ü§ñ Auto-Land: OFF</button>
        <button id="audio-btn">üîä Enable Audio</button>
        <button id="reset-btn" onclick="location.reload()">Reset</button>
    </div>

    <div id="mobile-controls">
        <div id="joystick-zone">
            <div id="joystick-knob"></div>
        </div>
        <div id="mobile-buttons">
            <button id="btn-stage">STAGE</button>
            <button id="btn-payload">PAYLOAD</button>
            <button id="btn-cam">CAM</button>
        </div>
        <div id="throttle-zone">
            <div id="throttle-handle"></div>
        </div>
    </div>

    <canvas id="canvas"></canvas>

    <!-- Load scripts in dependency order -->
    <script src="js/constants.js"></script>
    <script src="js/state.js"></script>
    <script src="js/utils/PIDController.js"></script>
    <script src="js/utils/AudioEngine.js"></script>
    <script src="js/utils/SAS.js"></script>
    <script src="js/ui/MissionLog.js"></script>
    <script src="js/ui/Navball.js"></script>
    <script src="js/ui/Telemetry.js"></script>
    <script src="js/physics/Particle.js"></script>
    <script src="js/physics/Vessel.js"></script>
    <script src="js/physics/RocketComponents.js"></script>
    <script src="js/utils/AssetLoader.js"></script>
    <script src="js/main.js"></script>
</body>

</html>